# Local Code Assistant - κµ¬ν„ κ³„ν (v3)

> λ΅μ»¬ LLM κΈ°λ° λ€ν™”ν• μ½”λ“ μ—μ΄μ „νΈ

---

## μ”κµ¬μ‚¬ν•­ μ •μ

| κµ¬λ¶„ | λ‚΄μ© |
|------|------|
| **μ„λ²„ (λ§¥λ¶μ—μ–΄ M3 16GB)** | Ollama + FastAPI, LLM μ¶”λ΅  λ‹΄λ‹Ή |
| **ν΄λΌμ΄μ–ΈνΈ (λ‹¤λ¥Έ PC)** | Python CLI, νμΌ μ‹μ¤ν… μ ‘κ·Ό + μ—μ΄μ „νΈ |
| **λ„¤νΈμ›ν¬** | Tailscale VPN (μλ™ μ•”νΈν™”) |
| **μ–Έμ–΄** | Python (μ„λ²„/ν΄λΌμ΄μ–ΈνΈ ν†µμΌ) |
| **λ©ν‘** | Claude Code κ°™μ€ λ€ν™”ν• κ²½ν— |

---

## ν•λ“μ›¨μ–΄ μ μ•½ λ° λ¨λΈ μ„ νƒ

| μ©λ„ | λ¨λΈ | ν¬κΈ° | μ»¨ν…μ¤νΈ |
|------|------|------|----------|
| **μ½”λ“ λ¶„μ„ (λ©”μΈ)** | `qwen2.5-coder:14b` | ~9GB | 128K |
| **μ„λ² λ”©** | `nomic-embed-text` | ~300MB | 8K |

---

## μ•„ν‚¤ν…μ²

```
[ Client PC ]                              [ MacBook M3 ]
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”                   β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚  CLI (Python)       β”‚                   β”‚  FastAPI Server     β”‚
β”‚  β”β”€ Agent Loop      β”‚   Tailscale       β”‚  β”β”€ Auth Middleware β”‚
β”‚  β”β”€ File Scanner    β”‚ β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β–Ί  β”‚  β”β”€ Ollama Client   β”‚
β”‚  β”β”€ Tool Executor   β”‚ β—„β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”‚  β””β”€ SSE Streaming   β”‚
β”‚  β””β”€ Context Manager β”‚      (SSE)        β”‚                     β”‚
β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”                   β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
```

**ν•µμ‹¬ μ›μΉ™:**
1. μ„λ²„λ” νμΌ μ‹μ¤ν…μ„ λ¨λ¥Έλ‹¤
2. ν΄λΌμ΄μ–ΈνΈκ°€ μ—μ΄μ „νΈ μ—­ν•  (λ„κµ¬ μ‹¤ν–‰)
3. λ¨λ“  μ‘λ‹µμ€ μ¤νΈλ¦¬λ°
4. μ‚¬μ©μ ν™•μΈ ν›„ μ½”λ“ μμ •

---

## μ§„ν–‰ μƒν™©

### Phase 1 - MVP β… μ™„λ£
- [x] FastAPI μ„λ²„ + Ollama μ—°λ™
- [x] SSE μ¤νΈλ¦¬λ°
- [x] API Key μΈμ¦
- [x] κΈ°λ³Έ CLI

### Phase 2 - μ»¨ν…μ¤νΈ κ΄€λ¦¬ β… μ™„λ£
- [x] νμΌ μ”μ•½ μƒμ„± + SQLite μ €μ¥
- [x] μ„λ² λ”© + ChromaDB
- [x] RAG κΈ°λ° μ»¨ν…μ¤νΈ κµ¬μ„±

### Phase 3 - Claude Code μ¤νƒ€μΌ π”¶ μ§„ν–‰μ¤‘
- [x] λ€ν™”ν• λ¨λ“
- [x] μ„¤μ • μλ™ ν”„λ΅¬ν”„νΈ
- [x] κ°„νΈν• CLI (`llmcode`)
- [ ] **μ—μ΄μ „νΈ λ£¨ν”„** - μ¤μΊ” μ—†μ΄ ν•„μ”ν• νμΌλ§ μ½κΈ°
- [ ] **ESCλ΅ μ‘μ—… μ¤‘μ§€**
- [ ] **μ½”λ“ μμ • μ‹ yes/no ν™•μΈ**
- [ ] `/include κ²½λ΅` - λ€ν™” μ¤‘ νμΌ μ¶”κ°€

### Phase 4 - κ³ κΈ‰ κΈ°λ¥ (μ„ νƒ)
- [ ] Git diff κΈ°λ° μ¦λ¶„ μ¤μΊ”
- [ ] λ©€ν‹° λ¨λΈ (μ”μ•½μ© μ‘μ€ λ¨λΈ, λ¶„μ„μ© ν° λ¨λΈ)
- [ ] μ½”λ“ μμ • β†’ ν¨μΉ μƒμ„± λ° μ μ©
- [ ] Claude API fallback (λ³µμ΅ν• μ§λ¬Έμ©)

---

## Phase 3 μƒμ„Έ μ„¤κ³„

### 3-1. μ—μ΄μ „νΈ λ£¨ν”„ (ν•µμ‹¬)

LLMμ΄ λ„κµ¬λ¥Ό μ”μ²­ν•λ©΄ ν΄λΌμ΄μ–ΈνΈκ°€ μ‹¤ν–‰:

```
μ‚¬μ©μ μ§λ¬Έ
    β†“
LLM μ‘λ‹µ (λ„κµ¬ μ”μ²­ ν¬ν•¨ κ°€λ¥)
    β†“
[λ„κµ¬ μ”μ²­ κ°μ§€?]
    β”β”€ Yes β†’ λ„κµ¬ μ‹¤ν–‰ β†’ κ²°κ³Όλ¥Ό LLMμ— μ „λ‹¬ β†’ λ°λ³µ
    β””β”€ No  β†’ μµμΆ… μ‘λ‹µ μ¶λ ¥
```

**λ„κµ¬ λ©λ΅:**
| λ„κµ¬ | μ„¤λ… |
|------|------|
| `list_files(path)` | λ””λ ‰ν† λ¦¬ νμΌ λ©λ΅ |
| `read_file(path)` | νμΌ λ‚΄μ© μ½κΈ° |
| `search(query)` | μ½”λ“ κ²€μƒ‰ (grep) |
| `write_file(path, content)` | νμΌ μ“°κΈ° (ν™•μΈ ν•„μ”) |

**LLM μ‘λ‹µ ν•μ‹:**
```
μΌλ° ν…μ¤νΈ μ‘λ‹µ...

<tool_call>
{"tool": "read_file", "args": {"path": "src/main.py"}}
</tool_call>
```

### 3-2. ESCλ΅ μ‘μ—… μ¤‘μ§€

- μ¤νΈλ¦¬λ° μ¤‘ ESC κ°μ§€
- μ¦‰μ‹ μ—°κ²° μΆ…λ£ + "μ¤‘μ§€λ¨" λ©”μ‹μ§€

### 3-3. μ½”λ“ μμ • ν™•μΈ

```
Assistant: src/main.pyλ¥Ό μμ •ν•κ² μµλ‹λ‹¤.

--- src/main.py (λ³€κ²½ μ „)
+++ src/main.py (λ³€κ²½ ν›„)
@@ -10,3 +10,5 @@
 def main():
-    print("hello")
+    print("hello world")

μ μ©ν• κΉμ”? [y/n]:
```

### 3-4. /include λ…λ Ήμ–΄

```
You: /include src/utils/
[OK] 3κ° νμΌ μ»¨ν…μ¤νΈμ— μ¶”κ°€λ¨

You: μ΄ μ ν‹Έ ν•¨μλ“¤ μ„¤λ…ν•΄μ¤
```

---

## κΈ°μ  μ¤νƒ

| κµ¬λ¶„ | κΈ°μ  |
|------|------|
| **μ„λ²„** | FastAPI, Uvicorn, SSE |
| **ν΄λΌμ΄μ–ΈνΈ** | Click, httpx, ChromaDB, Rich |
| **λ„¤νΈμ›ν¬** | Tailscale |
| **LLM** | Ollama (qwen2.5-coder:14b) |

---

## λ‹¤μ μ‘μ—…

1. **μ—μ΄μ „νΈ λ£¨ν”„ κµ¬ν„** - λ„κµ¬ νΈμ¶ νμ‹± + μ‹¤ν–‰
2. **ESC μ¤‘μ§€ κΈ°λ¥**
3. **μ½”λ“ μμ • ν™•μΈ UI**
4. **/include λ…λ Ήμ–΄**
